configfile: "config/config.yaml"


##### load rules #####


include: "rules/common.smk"
include: "rules/minknown.smk"
include: "rules/fastqs.smk"
include: "rules/align.smk"
include: "rules/qc.smk"


rule all:
    input:
        expand(
            "results/minknow/{experiment_id}_{sample_id}_throughput.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/minknow/{experiment_id}_{sample_id}_pore_act.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/minknow/{experiment_id}_{sample_id}_pore_seq.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/minknow/{experiment_id}_{sample_id}_pore_ratio.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/fastqs/{experiment_id}_{sample_id}.fastq.gz",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/qc/fastqc/{experiment_id}_{sample_id}_fastqc.zip",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/{experiment_id}_{sample_id}_aln.sorted.bam",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}.stats",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_MAPQ.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_INS.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_DEL.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_COV.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/qc/fastqc/{experiment_id}_{sample_id}.html",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_ref_dist.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        expand(
            "results/aligned/stats/{experiment_id}_{sample_id}_nm_counts.csv",
            zip,
            experiment_id=samples["experiment_id"],
            sample_id=samples["sample_id"],
        ),
        "results/qc/multiqc.html",
